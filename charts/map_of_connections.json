{
    "name": "Map showing client connections",
    "description": "A map with manual mappings of client IPs to latitude and longitude connection to a hypothetical data center in Cape Town, South Africa.",
    "report_category": "Database activity",
    "report_headers": [
        {
            "type": "Primary category",
            "replace": "$primary_category",
            "name": "Server hostname"
        },
        {
            "type": "Secondary category",
            "replace": "$secondary_category",
            "name": "Client IP"
        },
        {
            "type": "Primary value",
            "replace": "$primary_measure",
            "name": "Count"
        }
    ],
    "tips": [
        "In order to make practical use of this example, latitude and longitude mappings in the vega definition below should be replaced."
    ],
    "width": 600,
    "height": 400,
    "data": {
        "values": [
            {
                "Server hostname": "OSPREY.GDEMO.COM",
                "Client IP": "192.168.252.70",
                "Count": "2523132"
            },
            {
                "Server hostname": "RAPTOR.GDEMO.COM",
                "Client IP": "192.168.252.70",
                "Count": "436924"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "169.63.131.191",
                "Count": "16707"
            },
            {
                "Server hostname": "RAPTOR.GDEMO.COM",
                "Client IP": "192.168.252.229",
                "Count": "4658"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.63.131.191",
                "Count": "920"
            },
            {
                "Server hostname": "RAPTOR.GDEMO.COM",
                "Client IP": "192.168.252.239",
                "Count": "132"
            },
            {
                "Server hostname": "192.168.252.229",
                "Client IP": "192.168.252.70",
                "Count": "36"
            },
            {
                "Server hostname": "192.168.252.239",
                "Client IP": "192.168.252.70",
                "Count": "20"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "129.41.56.4",
                "Count": "14"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.148",
                "Count": "10"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.146.59",
                "Count": "10"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "116.12.186.83",
                "Count": "10"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.33",
                "Count": "10"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.63.131.178",
                "Count": "10"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.145.100",
                "Count": "10"
            },
            {
                "Server hostname": "SNOWGOOSE.GDEMO.COM",
                "Client IP": "192.168.252.240",
                "Count": "8"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.134",
                "Count": "7"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.146.53",
                "Count": "6"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.99",
                "Count": "6"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "103.6.151.193",
                "Count": "6"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.145.106",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.211",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.145.98",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.146.48",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.40",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.145.96",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.146.58",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.203",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.32",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.147",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.206",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.131",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.158",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "199.45.154.130",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.215",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.115",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.193",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.219",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.221",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.146.60",
                "Count": "5"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "167.94.145.99",
                "Count": "5"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.117",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "161.156.29.150",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.120",
                "Count": "4"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.213",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.63.131.175",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.63.131.176",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.101",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.107",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "161.156.29.129",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.161.164",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.182.105",
                "Count": "4"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "206.168.34.211",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.63.131.188",
                "Count": "4"
            },
            {
                "Server hostname": "TZ-AWS-POC3_PGSALESDB",
                "Client IP": "169.47.161.162",
                "Count": "4"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.13",
                "Count": "2"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.182",
                "Count": "2"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.142.125.210",
                "Count": "2"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.241",
                "Count": "2"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.248",
                "Count": "2"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.227",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.122",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.236",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.149",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.180",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.140",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.75",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.158",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.209",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.193",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.114",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.135",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.115",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.214",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.151",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.7",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.30",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.35",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.142",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.134",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.91",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.42",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.22",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.8",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.101",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.243",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.20",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.49",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.97",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.250",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.67",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.23",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.179",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.140",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.2",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.53",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.129",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.109",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.186",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.53",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.111",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.165",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.243",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.253",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.124",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.100",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.211",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.129",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.62",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.163",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.175",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.168",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.59",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.95",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.38",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.58",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.241",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.150",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.193",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.233",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.211.82",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.230",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.7",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.150.7",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.16",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.19",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.227",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.38",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "162.216.149.252",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "35.203.210.5",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.58",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.60",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.80",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.133.52",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "147.185.132.136",
                "Count": "1"
            },
            {
                "Server hostname": "AURORA-MYSQL01-INSTANCE-1",
                "Client IP": "87.236.176.33",
                "Count": "1"
            }
        ]
    },
    "vega_def": {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "width": "container",
        "height": "container",
        "data": {
            "name": "chartData"
        },
        "layer": [
            {
                "data": {
                    "url": "https://vega.github.io/editor/data/world-110m.json",
                    "format": {
                        "type": "topojson",
                        "feature": "countries"
                    }
                },
                "projection": {
                    "type": "equalEarth"
                },
                "mark": {
                    "type": "geoshape",
                    "fill": "transparent",
                    "stroke": "#4c4c4c"
                }
            },
            {
                "projection": {
                    "type": "equalEarth"
                },
                "transform": [
                    {
                        "calculate": "split(datum['$secondary_category'], '.')[0] + '.' + split(datum['$secondary_category'], '.')[1] + '.' + split(datum['$secondary_category'], '.')[2]",
                        "as": "first_3"
                    },
                    {
                        "calculate": "datum.first_3 + '.*'",
                        "as": "first_3_readable"
                    },
                    {
                        "calculate": "-33.9188",
                        "as": "destlat"
                    },
                    {
                        "calculate": "18.4233",
                        "as": "destlon"
                    },
                    {
                        "filter": "indexof(datum['$secondary_category'], '192.168') == -1"
                    },
                    {
                        "lookup": "first_3",
                        "from": {
                            "data": {
                                "values": [
                                    {
                                        "ipprefix": "87.236.176",
                                        "lat": 53.8008,
                                        "lon": -1.5485
                                    },
                                    {
                                        "ipprefix": "167.94.138",
                                        "lat": 50.1109,
                                        "lon": 8.6821
                                    },
                                    {
                                        "ipprefix": "167.94.145",
                                        "lat": 50.1109,
                                        "lon": 8.6821
                                    },
                                    {
                                        "ipprefix": "87.236.176",
                                        "lat": 38.8954,
                                        "lon": -77.0395
                                    },
                                    {
                                        "ipprefix": "35.203.210",
                                        "lat": 51.5098,
                                        "lon": -0.118
                                    },
                                    {
                                        "ipprefix": "35.203.211",
                                        "lat": 51.5098,
                                        "lon": -0.118
                                    },
                                    {
                                        "ipprefix": "206.168.34",
                                        "lat": 41.8818,
                                        "lon": -87.6231
                                    },
                                    {
                                        "ipprefix": "2.57.149",
                                        "lat": 55.7512,
                                        "lon": 37.6184
                                    },
                                    {
                                        "ipprefix": "199.45.155",
                                        "lat": 22.3027,
                                        "lon": 114.1772
                                    },
                                    {
                                        "ipprefix": "199.45.154",
                                        "lat": 22.3027,
                                        "lon": 114.1772
                                    },
                                    {
                                        "ipprefix": "169.63.131",
                                        "lat": 38.9527,
                                        "lon": -77.3412
                                    },
                                    {
                                        "ipprefix": "167.94.146",
                                        "lat": 50.1109,
                                        "lon": 8.6821
                                    },
                                    {
                                        "ipprefix": "162.142.125",
                                        "lat": 41.8818,
                                        "lon": -87.6231
                                    },
                                    {
                                        "ipprefix": "162.216.150",
                                        "lat": 32.8887,
                                        "lon": -80.0076
                                    },
                                    {
                                        "ipprefix": "162.216.149",
                                        "lat": 32.8887,
                                        "lon": -80.0076
                                    },
                                    {
                                        "ipprefix": "169.47.182",
                                        "lat": 38.8954,
                                        "lon": -77.0395
                                    },
                                    {
                                        "ipprefix": "169.47.161",
                                        "lat": 38.8954,
                                        "lon": -77.0395
                                    },
                                    {
                                        "ipprefix": "147.185.132",
                                        "lat": 33.1913,
                                        "lon": -80.004
                                    },
                                    {
                                        "ipprefix": "147.185.133",
                                        "lat": 37.3521,
                                        "lon": -121.9582
                                    },
                                    {
                                        "ipprefix": "103.6.151",
                                        "lat": 1.29027,
                                        "lon": 103.8519
                                    }
                                ]
                            },
                            "key": "ipprefix",
                            "fields": [
                                "lat",
                                "lon"
                            ],
                            "default": {
                                "lat": 42.3149,
                                "lon": -83.0364
                            }
                        }
                    }
                ],
                "layer": [
                    {
                        "mark": {
                            "type": "rule",
                            "strokeWidth": 1
                        },
                        "encoding": {
                            "longitude": {
                                "field": "lon",
                                "type": "quantitative"
                            },
                            "latitude": {
                                "field": "lat",
                                "type": "quantitative"
                            },
                            "longitude2": {
                                "field": "destlon"
                            },
                            "latitude2": {
                                "field": "destlat"
                            },
                            "color": {
                                "field": "Count",
                                "type": "quantitative",
                                "title": "Connection count",
                                "scale": {
                                    "scheme": "reds"
                                },
                                "legend": {
                                    "orient": "bottom"
                                }
                            }
                        }
                    },
                    {
                        "mark": {
                            "type": "circle",
                            "strokeWidth": 1.5
                        },
                        "encoding": {
                            "longitude": {
                                "field": "lon",
                                "type": "quantitative"
                            },
                            "latitude": {
                                "field": "lat",
                                "type": "quantitative"
                            },
                            "color": {
                                "field": "first_3_readable",
                                "title": "First 3 numbers in client IP"
                            }
                        }
                    }
                ]
            }
        ]
    }
}